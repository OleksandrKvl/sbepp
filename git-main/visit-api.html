<!-- HTML header for doxygen 1.9.6-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.13.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>sbepp: Visit API</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript">var page_layout=1;</script>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
  $(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="doxygen-awesome-darkmode-toggle.js"></script>
<script type="text/javascript" src="doxygen-awesome-paragraph-link.js"></script>
<script type="text/javascript" src="doxygen-awesome-interactive-toc.js"></script>
<script type="text/javascript">
    DoxygenAwesomeDarkModeToggle.init()
    DoxygenAwesomeParagraphLink.init()
    DoxygenAwesomeInteractiveToc.init()
</script>
<script type="text/javascript" src="version_selector_handler.js"></script>
</head>
<body>
<div id="side-nav" class="ui-resizable side-nav-resizable"><!-- do not remove this div, it is closed by doxygen! -->
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">sbepp<span id="projectnumber"/>
   </div>
  </td>
 </tr>
   <tr><td colspan="2">        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect"                onmouseover="return searchBox.OnSearchSelectShow()"                onmouseout="return searchBox.OnSearchSelectHide()">&#160;</span>
          <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</td></tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.13.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
</div><!-- top -->
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('visit-api.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Visit API</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="md__2home_2runner_2work_2sbepp_2sbepp_2doc_2visit__api"></a></p>
<p>Visit API provides a way to access various SBE entities and iterate over their inner parts. It can be used for <a class="el" href="examples.html#stringification-example">stringification</a> or conversion to another data format. <code>sbepp</code> uses this mechanism to implement <code><a class="el" href="namespacesbepp.html#abd9c1efb3c96d6fa71d1156811b47fa4" title="Calculate view size with additional safety checks.">sbepp::size_bytes_checked()</a></code> to gradually iterate over message parts and check that it fits into a buffer.</p>
<p>The API is based on two functions, <code><a class="el" href="namespacesbepp.html#a47c1cd81154bc5c56524604f74d52d27" title="Visit a view using given cursor.">sbepp::visit()</a></code> and <code><a class="el" href="namespacesbepp.html#a23abc2b6b892aea5b2b7f6dde6c24e69" title="Visit view&#39;s children using provided cursor.">sbepp::visit_children()</a></code>. They have different behavior but both have the same set of overloads:</p><ul>
<li><code>Visitor&amp;&amp; f(ThingToVisit, Visitor&amp;&amp;)</code></li>
<li><code>Visitor&amp;&amp; f(ThingToVisit, Cursor&amp;, Visitor&amp;&amp;)</code></li>
</ul>
<p>To be efficient, Visit API always uses <a class="el" href="representation.html#cursor-accessors">cursors</a> under the hood, the first overload creates it implicitly, the second relies on the provided one. <code>Visitor</code> is an object with member functions in form of <code>void/bool on_&lt;entity type&gt;(EntityValue, [Cursor&amp;,] EntityTag)</code>, where <code>&lt;entity type&gt;</code> corresponds to schema entity being visited, e.g. <code>on_message</code>, <code>on_group</code>, etc. When return type is <code>bool</code>, returned value works as a stop-flag, i.e., setting it to <code>true</code> stops further visiting. As described above, Visit API relies on cursor accessors, additional <code>Cursor&amp;</code> parameter allows to pass the cursor to a nested <code><a class="el" href="namespacesbepp.html#a47c1cd81154bc5c56524604f74d52d27" title="Visit a view using given cursor.">sbepp::visit()</a></code>/<code><a class="el" href="namespacesbepp.html#a23abc2b6b892aea5b2b7f6dde6c24e69" title="Visit view&#39;s children using provided cursor.">sbepp::visit_children()</a></code> call. <code>EntityTag</code> represents a <a class="el" href="traits.html#tags">tag</a> of an entity.</p>
<p>Note that visitor is not required to have all possible <code>on_&lt;entity type&gt;()</code> functions but only those that correspond to the structure of the object being visited. For example, composite visitor doesn't need <code>on_group()</code> function. If it has only type members, having <code>on_type()</code> is enough to visit it.</p>
<p>In general, visiting has two parts:</p><ul>
<li>visiting the parent object itself using <code><a class="el" href="namespacesbepp.html#a47c1cd81154bc5c56524604f74d52d27" title="Visit a view using given cursor.">sbepp::visit()</a></code></li>
<li>visiting its children using <code><a class="el" href="namespacesbepp.html#a23abc2b6b892aea5b2b7f6dde6c24e69" title="Visit view&#39;s children using provided cursor.">sbepp::visit_children()</a></code></li>
</ul>
<p>However, this order is not required, each call can be used independently from the other. For example, if one wants to visit composite members but not the composite object itself, there's nothing wrong with calling only <code><a class="el" href="namespacesbepp.html#a23abc2b6b892aea5b2b7f6dde6c24e69" title="Visit view&#39;s children using provided cursor.">sbepp::visit_children()</a></code> without <code><a class="el" href="namespacesbepp.html#a47c1cd81154bc5c56524604f74d52d27" title="Visit a view using given cursor.">sbepp::visit()</a></code>.</p>
<hr  />
<h1><a class="anchor" id="autotoc_md43"></a>
Visiting parent views</h1>
<p>Message/group/entry/composite views are called "parent" in this context because they are the only ones that can contain nested/children members. For them, <code><a class="el" href="namespacesbepp.html#a47c1cd81154bc5c56524604f74d52d27" title="Visit a view using given cursor.">sbepp::visit()</a></code> visits only the provided view itself. Here's a complete visitor interface for such a call:</p>
<div class="fragment"><div class="line"><span class="keyword">class </span>parent_visitor</div>
<div class="line">{</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">    <span class="keyword">template</span>&lt;<span class="keyword">typename</span> T, <span class="keyword">typename</span> Cursor, <span class="keyword">typename</span> Tag&gt;</div>
<div class="line">    <span class="keywordtype">void</span> on_message(T message, Cursor&amp; c, Tag);</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">template</span>&lt;<span class="keyword">typename</span> T, <span class="keyword">typename</span> Cursor, <span class="keyword">typename</span> Tag&gt;</div>
<div class="line">    <span class="keywordtype">bool</span> on_group(T group, Cursor&amp; c, Tag);</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">template</span>&lt;<span class="keyword">typename</span> T, <span class="keyword">typename</span> Cursor, <span class="keyword">typename</span> Tag&gt;</div>
<div class="line">    <span class="keywordtype">bool</span> on_entry(T entry, Cursor&amp; c, Tag);</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">template</span>&lt;<span class="keyword">typename</span> T, <span class="keyword">typename</span> Tag&gt;</div>
<div class="line">    <span class="keywordtype">bool</span> on_composite(T composite, Tag);</div>
<div class="line">};</div>
</div><!-- fragment --><p>For message, group and entry visitors, <code>Cursor&amp;</code> is provided to support efficient children visiting. For composites it's not needed because they support efficient member access without cursors.</p>
<hr  />
<h1><a class="anchor" id="autotoc_md45"></a>
Visiting children</h1>
<p><code><a class="el" href="namespacesbepp.html#a23abc2b6b892aea5b2b7f6dde6c24e69" title="Visit view&#39;s children using provided cursor.">sbepp::visit_children()</a></code> visits children of a parent view in the following way:</p><ul>
<li>for message and group entry, visits their <em>direct</em> field/group/data members in schema order</li>
<li>for group, visits all its entries</li>
<li>for composite, visits its type/enum/set/composite <em>direct</em> members in schema order</li>
</ul>
<p>Here's a corresponding visitor interface:</p>
<div class="fragment"><div class="line"><span class="keyword">class </span>children_visitor</div>
<div class="line">{</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">    <span class="keyword">template</span>&lt;<span class="keyword">typename</span> T, <span class="keyword">typename</span> Cursor, <span class="keyword">typename</span> Tag&gt;</div>
<div class="line">    <span class="keywordtype">bool</span> on_group(T group, Cursor&amp; c, Tag);</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">template</span>&lt;<span class="keyword">typename</span> T, <span class="keyword">typename</span> Cursor, <span class="keyword">typename</span> Tag&gt;</div>
<div class="line">    <span class="keywordtype">bool</span> on_entry(T entry, Cursor&amp; c, Tag);</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">template</span>&lt;<span class="keyword">typename</span> T, <span class="keyword">typename</span> Tag&gt;</div>
<div class="line">    <span class="keywordtype">bool</span> on_composite(T composite, Tag);</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">template</span>&lt;<span class="keyword">typename</span> T, <span class="keyword">typename</span> Tag&gt;</div>
<div class="line">    <span class="keywordtype">bool</span> on_data(T data, Tag);</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">template</span>&lt;<span class="keyword">typename</span> T, <span class="keyword">typename</span> Tag&gt;</div>
<div class="line">    <span class="keywordtype">bool</span> on_field(T field, Tag);</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">template</span>&lt;<span class="keyword">typename</span> T, <span class="keyword">typename</span> Tag&gt;</div>
<div class="line">    <span class="keywordtype">bool</span> on_type(T type, Tag);</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">template</span>&lt;<span class="keyword">typename</span> T, <span class="keyword">typename</span> Tag&gt;</div>
<div class="line">    <span class="keywordtype">bool</span> on_enum(T enumeration, Tag);</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">template</span>&lt;<span class="keyword">typename</span> T, <span class="keyword">typename</span> Tag&gt;</div>
<div class="line">    <span class="keywordtype">bool</span> on_set(T set, Tag);</div>
<div class="line">};</div>
</div><!-- fragment --><p>Note that a field can be represented by type/enum/set/composite so traits/concepts are often needed to distinguish them for further processing (e.g. <code><a class="el" href="namespacesbepp.html#a9b69b91021cb0ec2e5cba1f1d105fc60" title="Checks if T is a type of any kind.">sbepp::is_type</a></code>, <code><a class="el" href="conceptsbepp_1_1composite.html" title="Concept for sbepp::is_composite&lt;T&gt;::value">sbepp::composite</a></code>).</p>
<hr  />
<h1><a class="anchor" id="autotoc_md47"></a>
Visiting enums and sets</h1>
<p>When <code><a class="el" href="namespacesbepp.html#a47c1cd81154bc5c56524604f74d52d27" title="Visit a view using given cursor.">sbepp::visit()</a></code> is applied to a set, it visits all its known choices and passes their values/tags to a visitor via the following function:</p>
<div class="fragment"><div class="line"><span class="keyword">class </span>set_visitor{</div>
<div class="line">    <span class="keyword">template</span>&lt;<span class="keyword">typename</span> Tag&gt;</div>
<div class="line">    <span class="keywordtype">void</span> on_set_choice(<span class="keywordtype">bool</span> choice_value, Tag);</div>
<div class="line">};</div>
</div><!-- fragment --><p>For enums, <code><a class="el" href="namespacesbepp.html#a47c1cd81154bc5c56524604f74d52d27" title="Visit a view using given cursor.">sbepp::visit()</a></code> invokes visitor with enum value and its tag. When value is not one of the ones defined in schema, it provides <code><a class="el" href="structsbepp_1_1unknown__enum__value__tag.html" title="Tag for unknown enum values.">sbepp::unknown_enum_value_tag</a></code> as a tag. The visitor interface is:</p>
<div class="fragment"><div class="line"><span class="keyword">class </span>enum_visitor{</div>
<div class="line">    <span class="keyword">template</span>&lt;<span class="keyword">typename</span> T, <span class="keyword">typename</span> Tag&gt;</div>
<div class="line">    <span class="keywordtype">void</span> on_enum_value(T enumeration, Tag);</div>
<div class="line">};</div>
</div><!-- fragment --><p>See <a class="el" href="examples.html#stringification-example">stringification example</a> for an example of how all of the above can be used together to implement <code>to_string()</code>-like functionality. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.13.0 </li>
  </ul>
</div>
</body>
</html>
