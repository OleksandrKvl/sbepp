<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>sbepp: Visit API</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">sbepp
   &#160;<span id="projectnumber">1.0.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('visit-api.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Visit API </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="md__home_runner_work_sbepp_sbepp_doc_visit_api"></a> <code>sbepp</code> provides a way to visit a message/group/entry/composite and their children. This can be used for stringification or conversion to another format. <code>sbepp</code> uses this mechanism to implement <code><a class="el" href="namespacesbepp.html#abd9c1efb3c96d6fa71d1156811b47fa4" title="Calculate view size with additional safety checks.">sbepp::size_bytes_checked()</a></code>. It's based on two functions <code><a class="el" href="namespacesbepp.html#a5beafac5a9c1953ac0c80c2a6cf0f1a5" title="Visit a view using given cursor.">sbepp::visit()</a></code> and <code><a class="el" href="namespacesbepp.html#aa631879b7ddf4708f40417812e1183c9" title="Visit view&#39;s children using provided cursor.">sbepp::visit_children()</a></code>. They both have the same signature: <code>Visitor&amp;&amp; visit(View, Visitor&amp;&amp; = {})</code>. Here's the full visitor interface:</p>
<div class="fragment"><div class="line"><span class="keyword">class </span>my_visitor</div>
<div class="line">{</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">    <span class="keyword">template</span>&lt;<span class="keyword">typename</span> T, <span class="keyword">typename</span> Cursor, <span class="keyword">typename</span> Tag&gt;</div>
<div class="line">    <span class="keywordtype">void</span> on_message(T <a class="code" href="namespacesbepp.html#addc081b1e41e3c7c0cad7debe5baedb8">message</a>, Cursor&amp; c, Tag);</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">template</span>&lt;<span class="keyword">typename</span> T, <span class="keyword">typename</span> Cursor, <span class="keyword">typename</span> Tag&gt;</div>
<div class="line">    <span class="keywordtype">bool</span> on_group(T <a class="code" href="namespacesbepp.html#a17ff0ebf624153683436dfe195f3620c">group</a>, Cursor&amp; c, Tag);</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">template</span>&lt;<span class="keyword">typename</span> T, <span class="keyword">typename</span> Cursor, <span class="keyword">typename</span> Tag&gt;</div>
<div class="line">    <span class="keywordtype">bool</span> on_entry(T entry, Cursor&amp; c, Tag);</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">template</span>&lt;<span class="keyword">typename</span> T, <span class="keyword">typename</span> Tag&gt;</div>
<div class="line">    <span class="keywordtype">bool</span> on_data(T <a class="code" href="namespacesbepp.html#a756e4f6fc22bd4902e65d4808c8478ea">data</a>, Tag);</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">template</span>&lt;<span class="keyword">typename</span> T, <span class="keyword">typename</span> Tag&gt;</div>
<div class="line">    <span class="keywordtype">bool</span> on_field(T field, Tag);</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">template</span>&lt;<span class="keyword">typename</span> T, <span class="keyword">typename</span> Tag&gt;</div>
<div class="line">    <span class="keywordtype">bool</span> on_type(T <a class="code" href="namespacesbepp.html#aea2a55ea2dc060f3ba80f1f61cd6c455">type</a>, Tag);</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">template</span>&lt;<span class="keyword">typename</span> T, <span class="keyword">typename</span> Tag&gt;</div>
<div class="line">    <span class="keywordtype">bool</span> on_enum(T <a class="code" href="namespacesbepp.html#a4655caf42c163e92060f5a91fbe038c8">enumeration</a>, Tag);</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">template</span>&lt;<span class="keyword">typename</span> T, <span class="keyword">typename</span> Tag&gt;</div>
<div class="line">    <span class="keywordtype">bool</span> on_set(T <a class="code" href="namespacesbepp.html#a14f861120066ef3d1ed25b9fa898f7a8">set</a>, Tag);</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">template</span>&lt;<span class="keyword">typename</span> T, <span class="keyword">typename</span> Tag&gt;</div>
<div class="line">    <span class="keywordtype">bool</span> on_composite(T <a class="code" href="namespacesbepp.html#a5099bf79fe2e4724b4166b45b84c9270">composite</a>, Tag);</div>
<div class="line">};</div>
<div class="ttc" id="anamespacesbepp_html_a14f861120066ef3d1ed25b9fa898f7a8"><div class="ttname"><a href="namespacesbepp.html#a14f861120066ef3d1ed25b9fa898f7a8">sbepp::set</a></div><div class="ttdeci">concept set</div><div class="ttdoc">Concept for sbepp::is_set&lt;T&gt;::value</div><div class="ttdef"><b>Definition:</b> sbepp.hpp:4719</div></div>
<div class="ttc" id="anamespacesbepp_html_a17ff0ebf624153683436dfe195f3620c"><div class="ttname"><a href="namespacesbepp.html#a17ff0ebf624153683436dfe195f3620c">sbepp::group</a></div><div class="ttdeci">concept group</div><div class="ttdoc">Concept for sbepp::is_group&lt;T&gt;::value</div><div class="ttdef"><b>Definition:</b> sbepp.hpp:4739</div></div>
<div class="ttc" id="anamespacesbepp_html_a4655caf42c163e92060f5a91fbe038c8"><div class="ttname"><a href="namespacesbepp.html#a4655caf42c163e92060f5a91fbe038c8">sbepp::enumeration</a></div><div class="ttdeci">concept enumeration</div><div class="ttdoc">Concept for sbepp::is_enum&lt;T&gt;::value</div><div class="ttdef"><b>Definition:</b> sbepp.hpp:4715</div></div>
<div class="ttc" id="anamespacesbepp_html_a5099bf79fe2e4724b4166b45b84c9270"><div class="ttname"><a href="namespacesbepp.html#a5099bf79fe2e4724b4166b45b84c9270">sbepp::composite</a></div><div class="ttdeci">concept composite</div><div class="ttdoc">Concept for sbepp::is_composite&lt;T&gt;::value</div><div class="ttdef"><b>Definition:</b> sbepp.hpp:4723</div></div>
<div class="ttc" id="anamespacesbepp_html_a756e4f6fc22bd4902e65d4808c8478ea"><div class="ttname"><a href="namespacesbepp.html#a756e4f6fc22bd4902e65d4808c8478ea">sbepp::data</a></div><div class="ttdeci">concept data</div><div class="ttdoc">Concept for sbepp::is_data&lt;T&gt;::value</div><div class="ttdef"><b>Definition:</b> sbepp.hpp:4743</div></div>
<div class="ttc" id="anamespacesbepp_html_addc081b1e41e3c7c0cad7debe5baedb8"><div class="ttname"><a href="namespacesbepp.html#addc081b1e41e3c7c0cad7debe5baedb8">sbepp::message</a></div><div class="ttdeci">concept message</div><div class="ttdoc">Concept for sbepp::is_message&lt;T&gt;::value</div><div class="ttdef"><b>Definition:</b> sbepp.hpp:4727</div></div>
<div class="ttc" id="anamespacesbepp_html_aea2a55ea2dc060f3ba80f1f61cd6c455"><div class="ttname"><a href="namespacesbepp.html#aea2a55ea2dc060f3ba80f1f61cd6c455">sbepp::type</a></div><div class="ttdeci">concept type</div><div class="ttdoc">Concept for sbepp::is_type&lt;T&gt;::value</div><div class="ttdef"><b>Definition:</b> sbepp.hpp:4711</div></div>
</div><!-- fragment --><p>Most functions take value and its <a href="#tags">tag</a>, the <code>bool</code> return value works as a stop flag, i.e., should be set to <code>true</code> to stop visitation. Each function is called for the corresponding schema node so not all of them are required, only those for nodes in the object being visited. Note that field can be type/enum/set/composite, one needs to use corresponding traits/concepts (e.g. <code><a class="el" href="namespacesbepp.html#a3a24ee9045bb0d45e6656db2355592b4" title="Checks if T is a type of any kind.">sbepp::is_type</a></code>, <code><a class="el" href="namespacesbepp.html#a5099bf79fe2e4724b4166b45b84c9270" title="Concept for sbepp::is_composite&lt;T&gt;::value">sbepp::composite</a></code>) to get the actual field kind.</p>
<p>The difference between <code><a class="el" href="namespacesbepp.html#a5beafac5a9c1953ac0c80c2a6cf0f1a5" title="Visit a view using given cursor.">sbepp::visit()</a></code> and <code><a class="el" href="namespacesbepp.html#aa631879b7ddf4708f40417812e1183c9" title="Visit view&#39;s children using provided cursor.">sbepp::visit_children()</a></code> is that the former visits only the root object itself, while the latter visits only its children. To visit children recursively, additional <code>Cursor</code> parameter should be passed to <code><a class="el" href="namespacesbepp.html#aa631879b7ddf4708f40417812e1183c9" title="Visit view&#39;s children using provided cursor.">sbepp::visit_children</a></code> because under the hood visitation always uses cursors. <em>Note that when visiting message/group header from <code>on_message</code>/<code>on_group</code>, cursor should not be passed because headers are always skipped by cursors.</em> For example, here's how to visit message members:</p>
<div class="fragment"><div class="line"><span class="keyword">class </span>my_visitor</div>
<div class="line">{</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">    <span class="keyword">template</span>&lt;<span class="keyword">typename</span> T, <span class="keyword">typename</span> Cursor, <span class="keyword">typename</span> Tag&gt;</div>
<div class="line">    <span class="keywordtype">void</span> on_message(T <a class="code" href="namespacesbepp.html#addc081b1e41e3c7c0cad7debe5baedb8">message</a>, Cursor&amp; c, Tag)</div>
<div class="line">    {</div>
<div class="line">        <a class="code" href="namespacesbepp.html#aa631879b7ddf4708f40417812e1183c9">sbepp::visit_children</a>(<a class="code" href="namespacesbepp.html#addc081b1e41e3c7c0cad7debe5baedb8">message</a>, *<span class="keyword">this</span>, c);</div>
<div class="line">    }</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// ...</span></div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">auto</span> m = sbepp::make_view&lt;msg_type&gt;(buf.data(), buf.size());</div>
<div class="line">sbepp::visit&lt;my_visitor&gt;(m);</div>
<div class="ttc" id="anamespacesbepp_html_aa631879b7ddf4708f40417812e1183c9"><div class="ttname"><a href="namespacesbepp.html#aa631879b7ddf4708f40417812e1183c9">sbepp::visit_children</a></div><div class="ttdeci">constexpr Visitor &amp;&amp; visit_children(View view, Cursor &amp;c, Visitor &amp;&amp;visitor={})</div><div class="ttdoc">Visit view's children using provided cursor.</div><div class="ttdef"><b>Definition:</b> sbepp.hpp:4334</div></div>
</div><!-- fragment --><p>Without that <code><a class="el" href="namespacesbepp.html#aa631879b7ddf4708f40417812e1183c9" title="Visit view&#39;s children using provided cursor.">sbepp::visit_children</a></code>, only <code>on_message</code> will be called. <br  />
 Note that visitation can also be started from any group/entry/composite, not only from message.</p>
<p>See <a href="#stringification">Stringification primitives</a> section for an example how to build your own <code>to_string()</code>-like function using Visit API. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
